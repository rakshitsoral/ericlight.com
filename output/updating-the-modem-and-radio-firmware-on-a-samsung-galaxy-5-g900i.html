
<!DOCTYPE html>
<html lang="en">
<head>
  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css' integrity='sha256-aNiC51TQHvkWrMMLceXgyYnGfXL0IwDeIhxveiXOKFM=' crossorigin='anonymous'>

    <link rel="stylesheet" type="text/css" href="https://www.ericlight.com/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://www.ericlight.com/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="https://www.ericlight.com/theme/font-awesome/css/font-awesome.min.css">


    <link href="https://www.ericlight.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Such geek. Wow. Atom">



  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />


<meta name="author" content="Eric Light" />
<meta name="description" content="A couple months ago, Check Point revealed their discovery of the Quadrooter vulnerability affecting the Qualcomm chipsets in oodles of Android phones. I use CyanogenMod on a Samsung Galaxy S5, so thankfully I received patches for three of the four vulnerabilities in only a few days. However, that last vulnerability was part of a proprietary binary blob for controlling the Qualcomm LTE chipset, only patchable by Samsung themselves. It took a while for the Samsung updates to roll out, and then I got distracted for a while, but I finally ..." />
<meta name="keywords" content="Android, Security">
<meta property="og:site_name" content="Such geek. Wow."/>
<meta property="og:title" content="Updating the modem and radio firmware on a Samsung Galaxy 5 (G900I)"/>
<meta property="og:description" content="A couple months ago, Check Point revealed their discovery of the Quadrooter vulnerability affecting the Qualcomm chipsets in oodles of Android phones. I use CyanogenMod on a Samsung Galaxy S5, so thankfully I received patches for three of the four vulnerabilities in only a few days. However, that last vulnerability was part of a proprietary binary blob for controlling the Qualcomm LTE chipset, only patchable by Samsung themselves. It took a while for the Samsung updates to roll out, and then I got distracted for a while, but I finally ..."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://www.ericlight.com/articles/updating-the-modem-and-radio-firmware-on-a-samsung-galaxy-5-g900i.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2016-10-27 01:23:54.919323+13:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://www.ericlight.com/author/eric-light.html">
<meta property="article:section" content="Tech"/>
<meta property="article:tag" content="Android"/>
<meta property="article:tag" content="Security"/>
<meta property="og:image" content="">

  <title>Such geek. Wow. &ndash; Updating the modem and radio firmware on a Samsung Galaxy 5 (G900I)</title>
</head>
<body>
  <aside>
    <div>
      <a href="https://www.ericlight.com">
        <img src="https://www.ericlight.com/theme/img/profile.png" alt="Making things work" title="Making things work">
      </a>
      <h1><a href="https://www.ericlight.com">Making things work</a></h1>

<p>An eclectic collection of technical learnings and assorted challenges, for... reasons.</p>
      <nav>
        <ul class="list">
          <li><a href="https://www.ericlight.com/pages/about-me.html">About Me</a></li>

          <li><a href="http://python.org/" target="_blank">Python.org</a></li>
          <li><a href="http://jinja.pocoo.org/" target="_blank">Jinja2</a></li>
        </ul>
      </nav>

      <ul class="social">
        <li><a class="sc-linkedin" href="https://linkedin.com/in/ericdlight" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-github" href="https://github.com/rhyven" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-twitter" href="https://twitter.com/rhyvenNZ" target="_blank"><i class="fa fa-twitter"></i></a></li>
      </ul>
    </div>
  </aside>
  <main>

<article class="single">
  <header>
    <h1 id="updating-the-modem-and-radio-firmware-on-a-samsung-galaxy-5-g900i">Updating the modem and radio firmware on a Samsung Galaxy 5 (G900I)</h1>
    <p>
          Posted on Thu 27 October 2016 in <a href="https://www.ericlight.com/category/tech.html">Tech</a>


    </p>
  </header>
  <div>
    <p>A couple months ago, <a href="http://www.checkpoint.com">Check Point</a> revealed their discovery of the <a href="http://blog.checkpoint.com/2016/08/07/quadrooter/">Quadrooter vulnerability</a> affecting the Qualcomm chipsets in oodles of Android phones.</p>
<p>I use <a href="http://www.cyanogenmod.org">CyanogenMod</a> on a Samsung Galaxy S5, so thankfully I <a href="http://www.cyanogenmod.org/blog/cm-13-0-release-znh5y">received patches</a> for three of the four vulnerabilities in only a few days.</p>
<p>However, that last vulnerability was part of a proprietary binary blob for controlling the Qualcomm LTE chipset, only patchable by Samsung themselves.  It took a while for the Samsung updates to roll out, and then I got distracted for a while, but I finally downloaded my firmware.  The package I've used is "G900IDVU1CPH3", which seems to be compatible at least with the three NZ-based carriers, as well as all the Australian carriers.</p>
<p>There are a couple little issues with the firmware upgrade, easily fixed if you know how.  I'm going to assume you know exactly how to do everything without help.  I'm sure you're pleased.</p>
<p>In particular, the version of Heimdall in the Debian Sid repositories (1.4.1-2) doesn't quite work with the SGS5.  It appears <a href="https://www.google.com/search?q=ERROR%3A+Failed+to+send+request+to+end+PIT+file+transfer%21+samsung">other people</a> have had similar problems.</p>
<p>The beginning of fix for me came from <a href="https://github.com/turboyz">turboyz</a> on Github, at the bottom of this post:  <a href="https://github.com/Benjamin-Dobell/Heimdall/issues/348">https://github.com/Benjamin-Dobell/Heimdall/issues/348</a>; however, he's manually made a couple changes to BridgeManager.cpp, which appear to be no longer necessary.  We can simply build it from source:</p>
<div class="highlight"><pre><span></span>sudo apt-get install build-essential cmake zlib1g-dev libusb-1.0-0-dev git
git clone https://github.com/Benjamin-Dobell/Heimdall.git
cd Heimdall

# OPTIONAL:  Remove the `if(NOT DISABLE_FRONTEND)` codeblock at the end of Heimdall/CMakeLists.txt
# I believe this just saves time compiling the GUI

mkdir build &amp;&amp; cd build
cmake -DCMAKE_BUILD_TYPE=Release ..
make
cd bin
</pre></div>


<p>Now you've got a nice new Heimdall installation, with the approproate updates to allow it to talk nicely to the new Samsung bootloader.</p>
<p>I copied my new baseband files into the Heimdall/build/bin folder, just to get them all together.  The last step is to flash your NON-HLOS.bin and modem.bin files:</p>
<div class="highlight"><pre><span></span>./heimdall flash --APNHLOS NON-HLOS.bin --MODEM modem.bin
</pre></div>


<p>I happen to have an issue on my phone currently where, even though the modem and LTE drivers have both been successfully installed, and even thought the Quadrooter tester is no longer showing any vulnerabilities, my Baseband version on my phone is still shown as the old one.  I haven't been able to figure out why yet, but I don't think I'll worry about it for now.  There have been reports that you should first do this with --no-reboot, wait for the update to complete, then pull your battery, then when you power back on, immediately go <em>back</em> into download mode and re-flash.  Apparently this helps update the recognised Baseband version, but to be honest it didn't help me.</p>
<p>If you're completely 100% lucky and absolutely nothing goes wrong, you win!  You should now have the most recent Samsung modem and LTE chipset drivers available for your phone... without having to roll back to the stock Samsung firmware.</p>
<p>Incidentally, if you want to save gigabytes and time downloading said firmware, and if your phone is precisely a Samsung Galaxy S5 (G900I), and if you definitely want firmware G900IDVU1CPH3, I've extracted the important files (modem.bin and NON-HLOS.bin) and stored them here:</p>
<p><a href="https://www.ericlight.com/files/G900IDVU1CPH3_modem_LTE.zip">https://www.ericlight.com/files/G900IDVU1CPH3_modem_LTE.zip</a><br />
SHA256 hash = a2ab13063583f6e83a3c2d8b79521a59ba103dda30a24bddf9248dd5a25bff3c  </p>
<p>I promise I haven't intentionally backdoored them, but I make no warranties of any sort.  They might just be pictures of my foot.</p>
<p>Good luck!</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://www.ericlight.com/tag/android.html">Android</a>
      <a href="https://www.ericlight.com/tag/security.html">Security</a>
    </p>
  </div>



</article>

    <footer>
<p>&copy; Eric Light </p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>





<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Such geek. Wow. ",
  "url" : "https://www.ericlight.com",
  "image": "",
  "description": ""
}
</script>
</body>
</html>