
<!DOCTYPE html>
<html lang="en">
<head>
  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css' integrity='sha256-aNiC51TQHvkWrMMLceXgyYnGfXL0IwDeIhxveiXOKFM=' crossorigin='anonymous'>

    <link rel="stylesheet" type="text/css" href="https://www.ericlight.com/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://www.ericlight.com/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="https://www.ericlight.com/theme/font-awesome/css/font-awesome.min.css">


    <link href="https://www.ericlight.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Such geek. Wow. Atom">



  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />


<meta name="author" content="Eric Light" />
<meta name="description" content="Schneider Electric's PowerChute Network Shutdown is a piece of software which communicates with your local UPS, and initiates system shutdown if the UPS battery is unable to continue providing power. This helps to preserve file integrity in the event of a prolonged power failure. Previously, you had to install the PCNS client separately on each virtual machine. Since then though, APC have released a PCNS VMware Appliance which is installed directly into vCenter, and initiates shutdown on all the VMware guests through a single Virtual Machine. This is a ..." />
<meta name="keywords" content="UPS">
<meta property="og:site_name" content="Such geek. Wow."/>
<meta property="og:title" content="Broken log times in APC's PCNS Appliance 4.1"/>
<meta property="og:description" content="Schneider Electric's PowerChute Network Shutdown is a piece of software which communicates with your local UPS, and initiates system shutdown if the UPS battery is unable to continue providing power. This helps to preserve file integrity in the event of a prolonged power failure. Previously, you had to install the PCNS client separately on each virtual machine. Since then though, APC have released a PCNS VMware Appliance which is installed directly into vCenter, and initiates shutdown on all the VMware guests through a single Virtual Machine. This is a ..."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://www.ericlight.com/articles/broken-log-times-in-apcs-pcns-appliance-41.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2016-10-27 22:28:02.131178+13:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://www.ericlight.com/author/eric-light.html">
<meta property="article:section" content="Tech"/>
<meta property="article:tag" content="UPS"/>
<meta property="og:image" content="">

  <title>Such geek. Wow. &ndash; Broken log times in APC's PCNS Appliance 4.1</title>
</head>
<body>
  <aside>
    <div>
      <a href="https://www.ericlight.com">
        <img src="https://www.ericlight.com/theme/img/profile.png" alt="Making things work" title="Making things work">
      </a>
      <h1><a href="https://www.ericlight.com">Making things work</a></h1>

<p>An eclectic collection of technical learnings and assorted challenges, for... reasons.</p>
      <nav>
        <ul class="list">
          <li><a href="https://www.ericlight.com/pages/about-me.html">About Me</a></li>

          <li><a href="http://python.org/" target="_blank">Python.org</a></li>
          <li><a href="http://jinja.pocoo.org/" target="_blank">Jinja2</a></li>
        </ul>
      </nav>

      <ul class="social">
        <li><a class="sc-linkedin" href="https://linkedin.com/in/ericdlight" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-github" href="https://github.com/rhyven" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-twitter" href="https://twitter.com/rhyvenNZ" target="_blank"><i class="fa fa-twitter"></i></a></li>
      </ul>
    </div>
  </aside>
  <main>

<article class="single">
  <header>
    <h1 id="broken-log-times-in-apcs-pcns-appliance-41">Broken log times in APC's PCNS Appliance 4.1</h1>
    <p>
          Posted on Thu 27 October 2016 in <a href="https://www.ericlight.com/category/tech.html">Tech</a>


    </p>
  </header>
  <div>
    <p>Schneider Electric's <a href="http://www.schneider-electric.com/en/product-range/61933-powerchute-network-shutdown/">PowerChute Network Shutdown</a> is a piece of software which communicates with your local UPS, and initiates system shutdown if the UPS battery is unable to continue providing power.  This helps to preserve file integrity in the event of a prolonged power failure.</p>
<p>Previously, you had to install the PCNS client separately on each virtual machine.  Since then though, APC have released a <a href="https://solutionexchange.vmware.com/store/products/apc-powerchute-network-shutdown-v4-1-for-vmware">PCNS VMware Appliance</a> which is installed directly into vCenter, and initiates shutdown on all the VMware guests through a single Virtual Machine.  This is a much tidier model, so we've recently embarked on migrating to the PCNS Appliance.</p>
<p>After installing the PCNS 4.1 appliance and getting everything working, I discovered that the time on all the log files was wrong by a significant margin.  I can't remember exactly what the margin was, it could have been say 8 hours or something.</p>
<p>I did a bit of research and eventually I discovered a spectaularly old question on the APC forums, dating all the way back to 2011:</p>
<p><em>"I have installed PCNS 2.2.4 into the vMA of an ESXi 4.1 server. It properly communicates with the associated NMC and performs correctly. However, it reports all the activities in Eastern Standard Time. I don't know where it's picking up that time zone and can't find anywhere to change it. In the vSphere client the time shows up correctly. Checking date inside the vMA from the CLI also shows the correct time and timezone. The date and time setting in the NMC is correct and is set to synch with NTP with correct time zone."</em><br />
From: <a href="http://forums.apc.com/spaces/7/ups-management-devices-powerchute-software/forums/general/6809/pcns-2-2-4-esxi-annoyance">http://forums.apc.com/spaces/7/ups-management-devices-powerchute-software/forums/general/6809/pcns-2-2-4-esxi-annoyance</a></p>
<p>The answers include a broken link to an APC web page about it, but fortunately the poster copied the original post detail, which showed me where to look:</p>
<p><em>"PCNS uses a standard java function to retrieve the current date from the system when writing events to the log. The Problem on the VIMA is that this function always returns the US date format (PDT).<br />
This is an issue with Java http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6456628<br />
You can correct the time issue on VIMA by modifying /etc/sysconfig/clock file.<br />
+/etc/sysconfig/clock contains a line ZONE="America/Los_Angeles"+<br />
You need to edit the ZONE= to match your region such as ZONE="America/New_York"</em></p>
<p>Sounds great!  But when I looked in /etc/sysconfig/clock, I discovered my time zone was already set to "Pacific/Auckland".</p>
<p>However, it also contained the value "UTC = False".  I changed this to "UTC = True", and et voil√†!  The problem is fixed!</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://www.ericlight.com/tag/ups.html">UPS</a>
    </p>
  </div>



</article>

    <footer>
<p>&copy; Eric Light </p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>





<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Such geek. Wow. ",
  "url" : "https://www.ericlight.com",
  "image": "",
  "description": ""
}
</script>
</body>
</html>